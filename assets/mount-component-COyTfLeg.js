import{a as ae,r as se,I as M,e as j,P as le}from"./index-s5J9asle.js";import{aS as ie,a6 as ce,d as _,e as p,c as D,aT as re,a as r,q as g,v as k,N as $,ad as ue,w as N,t as C,a3 as V,I as de,n as fe,l as q,m as ve,B as K,aU as ye,r as A,C as G,at as Y,ab as W,A as me,R as Z,_ as J,$ as Q,a0 as L,f as ge,g as X,K as he,L as be,an as Ie,aV as Se,F as Ce,aH as Pe,a4 as Oe,aW as ke,y as xe}from"./index-CpL1zRha.js";function we(e,{args:t=[],done:n,canceled:s,error:a}){if(e){const c=e.apply(null,t);ie(c)?c.then(f=>{f?n():s&&s()}).catch(a||ce):c?n():s&&s()}else n()}const[Be,S]=D("button"),Te=p({},se,{tag:g("button"),text:String,icon:String,type:g("default"),size:g("normal"),color:String,block:Boolean,plain:Boolean,round:Boolean,square:Boolean,loading:Boolean,hairline:Boolean,disabled:Boolean,iconPrefix:String,nativeType:g("button"),loadingSize:k,loadingText:String,loadingType:String,iconPosition:g("left")});var ze=_({name:Be,props:Te,emits:["click"],setup(e,{emit:t,slots:n}){const s=ae(),a=()=>n.loading?n.loading():r(ue,{size:e.loadingSize,type:e.loadingType,class:S("loading")},null),c=()=>{if(e.loading)return a();if(n.icon)return r("div",{class:S("icon")},[n.icon()]);if(e.icon)return r(M,{name:e.icon,class:S("icon"),classPrefix:e.iconPrefix},null)},f=()=>{let o;if(e.loading?o=e.loadingText:o=n.default?n.default():e.text,o)return r("span",{class:S("text")},[o])},l=()=>{const{color:o,plain:u}=e;if(o){const d={color:u?o:"white"};return u||(d.background=o),o.includes("gradient")?d.border=0:d.borderColor=o,d}},y=o=>{e.loading?$(o):e.disabled||(t("click",o),s())};return()=>{const{tag:o,type:u,size:d,block:P,round:h,plain:b,square:I,loading:v,disabled:x,hairline:w,nativeType:R,iconPosition:B}=e,T=[S([u,d,{plain:b,block:P,round:h,square:I,loading:v,disabled:x,hairline:w}]),{[re]:w}];return r(o,{type:R,class:T,style:l(),disabled:x,onClick:y},{default:()=>[r("div",{class:S("content")},[B==="left"&&c(),f(),B==="right"&&c()])]})}}});const je=N(ze),ee={show:Boolean,zIndex:k,overlay:C,duration:k,teleport:[String,Object],lockScroll:C,lazyRender:C,beforeClose:Function,overlayStyle:Object,overlayClass:V,transitionAppear:Boolean,closeOnClickOverlay:C},Fe=Object.keys(ee);let O=0;const F="van-overflow-hidden";function Ae(e,t){const n=de(),s="01",a="10",c=u=>{n.move(u);const d=n.deltaY.value>0?a:s,P=ye(u.target,e.value),{scrollHeight:h,offsetHeight:b,scrollTop:I}=P;let v="11";I===0?v=b>=h?"00":"01":I+b>=h&&(v="10"),v!=="11"&&n.isVertical()&&!(parseInt(v,2)&parseInt(d,2))&&$(u,!0)},f=()=>{document.addEventListener("touchstart",n.start),document.addEventListener("touchmove",c,{passive:!1}),O||document.body.classList.add(F),O++},l=()=>{O&&(document.removeEventListener("touchstart",n.start),document.removeEventListener("touchmove",c),O--,O||document.body.classList.remove(F))},y=()=>t()&&f(),o=()=>t()&&l();fe(y),q(o),ve(o),K(t,u=>{u?f():l()})}function ne(e){const t=A(!1);return K(e,n=>{n&&(t.value=n)},{immediate:!0}),n=>()=>t.value?n():null}const[pe,Re]=D("overlay"),Ee={show:Boolean,zIndex:k,duration:k,className:V,lockScroll:C,lazyRender:C,customStyle:Object,teleport:[String,Object]};var Le=_({name:pe,inheritAttrs:!1,props:Ee,setup(e,{attrs:t,slots:n}){const s=A(),a=ne(()=>e.show||!e.lazyRender),c=l=>{e.lockScroll&&$(l,!0)},f=a(()=>{var l;const y=p(me(e.zIndex),e.customStyle);return Z(e.duration)&&(y.animationDuration=`${e.duration}s`),J(r("div",L({ref:s,style:y,class:[Re(),e.className]},t),[(l=n.default)==null?void 0:l.call(n)]),[[Q,e.show]])});return G("touchmove",c,{target:s}),()=>{const l=r(Y,{name:"van-fade",appear:!0},{default:f});return e.teleport?r(W,{to:e.teleport},{default:()=>[l]}):l}}});const _e=N(Le),De=p({},ee,{round:Boolean,position:g("center"),closeIcon:g("cross"),closeable:Boolean,transition:String,iconPrefix:String,closeOnPopstate:Boolean,closeIconPosition:g("top-right"),destroyOnClose:Boolean,safeAreaInsetTop:Boolean,safeAreaInsetBottom:Boolean}),[$e,H]=D("popup");var Ne=_({name:$e,inheritAttrs:!1,props:De,emits:["open","close","opened","closed","keydown","update:show","clickOverlay","clickCloseIcon"],setup(e,{emit:t,attrs:n,slots:s}){let a,c;const f=A(),l=A(),y=ne(()=>e.show||!e.lazyRender),o=ge(()=>{const i={zIndex:f.value};if(Z(e.duration)){const m=e.position==="center"?"animationDuration":"transitionDuration";i[m]=`${e.duration}s`}return i}),u=()=>{a||(a=!0,f.value=e.zIndex!==void 0?+e.zIndex:Se(),t("open"))},d=()=>{a&&we(e.beforeClose,{done(){a=!1,t("close"),t("update:show",!1)}})},P=i=>{t("clickOverlay",i),e.closeOnClickOverlay&&d()},h=()=>{if(e.overlay)return r(_e,L({show:e.show,class:e.overlayClass,zIndex:f.value,duration:e.duration,customStyle:e.overlayStyle,role:e.closeOnClickOverlay?"button":void 0,tabindex:e.closeOnClickOverlay?0:void 0},j(),{onClick:P}),{default:s["overlay-content"]})},b=i=>{t("clickCloseIcon",i),d()},I=()=>{if(e.closeable)return r(M,{role:"button",tabindex:0,name:e.closeIcon,class:[H("close-icon",e.closeIconPosition),Pe],classPrefix:e.iconPrefix,onClick:b},null)};let v;const x=()=>{v&&clearTimeout(v),v=setTimeout(()=>{t("opened")})},w=()=>t("closed"),R=i=>t("keydown",i),B=y(()=>{var i;const{destroyOnClose:m,round:E,position:z,safeAreaInsetTop:te,safeAreaInsetBottom:oe,show:U}=e;if(!(!U&&m))return J(r("div",L({ref:l,style:o.value,role:"dialog",tabindex:0,class:[H({round:E,[z]:z}),{"van-safe-area-top":te,"van-safe-area-bottom":oe}],onKeydown:R},n,j()),[(i=s.default)==null?void 0:i.call(s),I()]),[[Q,U]])}),T=()=>{const{position:i,transition:m,transitionAppear:E}=e,z=i==="center"?"van-fade":`van-popup-slide-${i}`;return r(Y,{name:m||z,appear:E,onAfterEnter:x,onAfterLeave:w},{default:B})};return K(()=>e.show,i=>{i&&!a&&(u(),n.tabindex===0&&Ce(()=>{var m;(m=l.value)==null||m.focus()})),!i&&a&&(a=!1,t("close"))}),X({popupRef:l}),Ae(l,()=>e.show&&e.lockScroll),G("popstate",()=>{e.closeOnPopstate&&(d(),c=!1)}),he(()=>{e.show&&u()}),be(()=>{c&&(t("update:show",!0),c=!1)}),q(()=>{e.show&&e.teleport&&(d(),c=!0)}),Oe(le,()=>e.show),()=>e.teleport?r(W,{to:e.teleport},{default:()=>[h(),T()]}):r(Ie,null,[h(),T()])}});const He=N(Ne);function Me(){const e=xe({show:!1}),t=a=>{e.show=a},n=a=>{p(e,a,{transitionAppear:!0}),t(!0)},s=()=>t(!1);return X({open:n,close:s,toggle:t}),{open:n,close:s,state:e,toggle:t}}function Ve(e){const t=ke(e),n=document.createElement("div");return document.body.appendChild(n),{instance:t.mount(n),unmount(){t.unmount(),document.body.removeChild(n)}}}export{je as B,He as P,ee as a,we as c,Ve as m,Fe as p,Me as u};
