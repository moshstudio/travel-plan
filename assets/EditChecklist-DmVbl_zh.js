import{d as C,ae as x,r as h,y as q,K as P,L as S,ag as U,a as l,ai as v,am as n,af as f,ah as B,au as g,ap as N,aD as A,aq as D}from"./index-CpL1zRha.js";import{C as E,F,a as z}from"./index-BTvapICq.js";import{S as L,a as M}from"./index-Chr0kTgw.js";import{d as R,N as G}from"./index-s5J9asle.js";import{T as K,P as j}from"./TravelTagSelector-DbdAJ--R.js";import{B as H}from"./mount-component-COyTfLeg.js";import{s as r,a as J}from"./function-call-bTWHa3iy.js";import"./index-CvqAlFEX.js";const O={class:"w-screen h-screen flex flex-col overflow-hidden bg-[var(--van-background)]"},Q={class:"flex-grow w-full h-full p-2 overflow-auto"},W={class:"p-4"},X=C({__name:"EditChecklist",props:{itemId:String},setup(i){const s=R(),{currentTravel:m}=x(s),o=h(),e=q({itemId:"",name:"",tags:[],quantity:1,notes:"",priority:"medium",isPacked:!1}),c=async()=>{if(console.log("checklistItemId:",i.itemId),!!i.itemId){if(o.value=await s.getChecklistItem(i.itemId),!o.value){r("清单项不存在"),u();return}e.itemId=o.value.itemId,e.name=o.value.name,e.tags=[o.value.tag],e.quantity=o.value.quantity,e.notes=o.value.notes||"",e.priority=o.value.importance,e.isPacked=o.value.isPacked,console.log("checklistItem:",o.value)}},y=async()=>{if(!e.name||!e.tags.length){r("请填写必填信息");return}if(!m.value){r("请先创建旅行"),f.push({name:"CreateTravel"});return}if(!o.value){r("清单不存在");return}const p=new Date,t=A({id:o.value.id,itemId:e.itemId,name:e.name,travelId:m.value.travelId,tag:e.tags[0],isPacked:e.isPacked,quantity:e.quantity,importance:e.priority,notes:e.notes,createdAt:o.value.createdAt,updatedAt:p});console.log("提交的清单项数据:",t),await s.updateTravelChecklist(t),J("清单项更新成功"),u()},u=()=>{f.push({name:"Travel"})},k=["衣物","电子设备","证件","洗漱用品","药品","食品","户外用品","其他"];return P(async()=>{await c()}),S(async()=>{await c()}),(p,t)=>{const _=G,d=F,w=L,V=M,I=z,T=E,b=H;return B(),U("div",O,[l(_,{title:"编辑清单项","left-arrow":"",onClickLeft:u}),v("div",Q,[l(T,{inset:""},{default:n(()=>[l(d,{modelValue:e.name,"onUpdate:modelValue":t[0]||(t[0]=a=>e.name=a),label:"物品名称",placeholder:"请输入物品名称",clearable:"",required:""},null,8,["modelValue"]),l(K,{tags:e.tags,"custom-tags":g(s).customTravelChecklistTags,"onUpdate:tags":t[1]||(t[1]=a=>e.tags=a),"onUpdate:customTags":t[2]||(t[2]=a=>g(s).updateCustomTravelChecklistTags(a)),"default-tags":k,"max-tags":1},null,8,["tags","custom-tags"]),l(d,{modelValue:e.quantity,"onUpdate:modelValue":t[4]||(t[4]=a=>e.quantity=a),modelModifiers:{number:!0},label:"数量",type:"number"},{extra:n(()=>[l(w,{modelValue:e.quantity,"onUpdate:modelValue":t[3]||(t[3]=a=>e.quantity=a),min:"1"},null,8,["modelValue"])]),_:1},8,["modelValue"]),l(j,{modelValue:e.priority,"onUpdate:modelValue":t[5]||(t[5]=a=>e.priority=a)},null,8,["modelValue"]),l(I,{title:"打包状态"},{value:n(()=>[l(V,{modelValue:e.isPacked,"onUpdate:modelValue":t[6]||(t[6]=a=>e.isPacked=a),size:"24"},null,8,["modelValue"])]),_:1}),l(d,{modelValue:e.notes,"onUpdate:modelValue":t[7]||(t[7]=a=>e.notes=a),rows:"3",autosize:"",label:"备注",type:"textarea",placeholder:"请输入备注信息","show-word-limit":"",maxlength:"200"},null,8,["modelValue"])]),_:1}),v("div",W,[l(b,{round:"",block:"",type:"primary",class:"bg-blue-500",onClick:y},{default:n(()=>t[8]||(t[8]=[N(" 更新清单项 ")])),_:1,__:[8]})])])])}}}),se=D(X,[["__scopeId","data-v-50d7dcc6"]]);export{se as default};
